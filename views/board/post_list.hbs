<div class="wrapper">

  {{> header_navigation}}

  <!--=== Breadcrumbs ===-->
  <div class="breadcrumbs">
    <div class="container">
      <h1 class="pull-left"><a href="/board/free/posts">{{TRANSLATION "board.name.free"}}</a></h1>
      <ul class="pull-right breadcrumb">
        <li class="active">{{TRANSLATION "board.free.breadcrumbs.posts"}}</li>
        <li>
          <a href="/board/free/comments">{{TRANSLATION "board.free.breadcrumbs.comments"}}</a>
        </li>
      </ul>
    </div><!--/container-->
  </div><!--/breadcrumbs-->
  <!--=== End Breadcrumbs ===-->

  <!--=== Content Part ===-->
  <div class="container content" ng-controller="boardCtrl">

    <div class="row">
      <!--Top Likes Rows-->
      <div class="col-md-6">
        <h2 class="heading-sm">
          <i class="icon-custom rounded-x icon-sm icon-color-u fa fa-thumbs-o-up"></i>
          <span>{{TRANSLATION "board.top.likes"}}</span>
        </h2>
        {{#if topLikes.length}}
        <table class="table table-hover">
          <tbody>
            {{#each topLikes}}
            <tr>
              <td class="text-overflow max-width-240">
                <a ng-href="/board/free/{{seq}}?page={{../number}}&category={{../category}}">
                  <strong>
                    {{#if status.delete}}
                      {{TRANSLATION "board.msg.deleted"}}
                    {{else}}
                      {{subject}}
                    {{/if}}
                  </strong>
                </a>
              </td>
              <td>
                <span class="text-primary">
                  <i class="fa fa-thumbs-o-up"></i> <strong>{{count}}</strong>
                </span>
              </td>
            </tr>
            {{/each}}
          </tbody>
        </table>
        {{/if}}
      </div>
      <!--End Top Likes Rows-->
      <!--Top Comments Rows-->
      <div class="col-md-6">
        <h2 class="heading-sm">
          <i class="icon-custom rounded-x icon-sm icon-color-u fa fa-comment-o"></i>
          <span>{{TRANSLATION "board.top.comments"}}</span>
        </h2>
        {{#if topComments.length}}
        <table class="table table-hover ng-cloak">
          <tbody>
            {{#each topComments}}
            <tr>
              <td class="text-overflow max-width-240">
                <a ng-href="/board/free/{{seq}}?page={{../number}}&category={{../category}}">
                  <strong>
                    {{#if status.delete}}
                      {{TRANSLATION "board.msg.deleted"}}
                    {{else}}
                      {{subject}}
                    {{/if}}
                  </strong>
                </a>
              </td>
              <td>
                <span class="text-default">
                  <i class="fa fa-comment-o"></i> <strong>{{count}}</strong>
                </span>
              </td>
            </tr>
            {{/each}}
          </tbody>
        </table>
        {{/if}}
      </div>
      <!--End Top Comments Rows-->
    </div>

    <!-- Top Buttons -->
    <div class="row">
      <div class="col-sm-6 margin-bottom-10">
        <button type="button" class="btn-u rounded dropdown-toggle" data-toggle="dropdown">
        {{#if (NOT_EQ category 'ALL')}}
          {{CATEGORY_NAME (PICK_CATEGORY categories category) locale}}
        {{else}}
          {{TRANSLATION "board.category.all"}}
        {{/if}}
          <i class="fa fa-angle-down"></i>
        </button>
        <ul class="dropdown-menu" role="menu">
        {{#if (NOT_EQ category 'ALL')}}
          <li><a href="?category=ALL">{{TRANSLATION "board.category.all"}}</a></li>
        {{/if}}
        {{#each categories as |category|}}
          {{#if (NOT_EQ category.code ../category)}}
            <li><a href="?category={{category.code}}">{{CATEGORY_NAME category ../locale}}</a></li>
          {{/if}}
        {{/each}}
        </ul>
        {{> write_button}}
      </div>
      <div class="col-sm-6 sm-margin-bottom-10">
        <div class="input-group">
          <input type="text" class="form-control" ng-model="searchWords" ng-init="searchWords=''"
            ng-keypress="($event.which === 13)?btnEnter():return"
            placeholder='{{TRANSLATION "search.placeholder.words"}}'>
           <span class="input-group-btn">
             <button class="btn-u" type="button" ng-click="btnEnter();"><i class="fa fa-search"></i></button>
           </span>
        </div>
      </div>
    </div>
    <!-- End Top Buttons -->

    <div class="panel panel-u">
      <div class="panel-heading hidden-xs">
        <div class="row">
          <div class="col-sm-2">{{TRANSLATION "board.number"}} &mid; {{TRANSLATION "board.category"}}</div>
          <div class="col-sm-4">{{TRANSLATION "board.subject"}}</div>
          <div class="col-sm-3">{{TRANSLATION "board.writer"}} &mid; {{TRANSLATION "common.date"}}</div>
          <div class="col-sm-3">{{TRANSLATION "board.views"}} &mid; {{TRANSLATION "common.like"}} &mid; {{TRANSLATION "common.dislike"}}</div>
        </div>
      </div> <!-- /panel-heading -->

      <ul class="list-group">
        <!-- posts as notice -->
        {{#each notices}}
          <li class="list-group-item list-group-item-info">
            <div class="row">
              <div class="col-sm-2">
                <span aria-hidden="true" class="icon-directions visible-xs-inline"></span>{{TRANSLATION "board.notice"}}
              </div>
              <div class="col-sm-4">
                {{#if (EQ status.device 'MOBILE')}}<span aria-hidden="true" class="icon-screen-smartphone"></span>{{/if}}
                {{#if (EQ status.device 'TABLET')}}<span aria-hidden="true" class=" icon-screen-tablet"></span>{{/if}}
                {{#if (OPR '>' galleries.length 0)}}<span aria-hidden="true" class="icon-picture"></span>{{/if}}
                <a href="/board/free/{{seq}}?page={{../number}}&category={{category}}">
                  {{#if status.delete}}
                    <strong>{{TRANSLATION "board.msg.deleted"}}</strong>
                  {{else}}
                    <strong>{{subject}}</strong>
                  {{/if}}
                  {{#if commentCount}}
                    <span class="text-success">[{{commentCount}}]</span>
                  {{/if}}
                </a>
              </div>
              <div class="col-sm-3">
                <span aria-hidden="true" class="icon-user visible-xs-inline"></span>{{writer.username}} |
              {{#if (OPR '<' (DATE_BY_ID id) ../todayDate)}}
                <span>{{DATE_FORMAT (DATE_BY_ID id) 'LL'}}</span>
              {{else}}
                <span>{{DATE_FORMAT (DATE_BY_ID id) 'LTS'}}</span>
              {{/if}}
              </div>
              <div class="col-sm-3 hidden-xs">
                <span aria-hidden="true" class="icon-eye"></span> <strong>{{views}}</strong>
                <span class="text-primary">
                  <i class="fa fa-thumbs-o-up"></i>
                  <strong>{{likingCount}}</strong>
                </span>
                <span class="text-danger">
                  <i class="fa fa-thumbs-o-down"></i>
                  <strong>{{dislikingCount}}</strong>
                </span>
              </div>
            </div>
          </li>
        {{/each}}

        <!-- posts -->
        {{#each posts}}
          <li class="list-group-item">
            <div class="row">
              <div class="col-sm-2">
              {{seq}} <span class="hidden-xs">&mid;</span>
              {{#if category}}
                <span aria-hidden="true" class="icon-directions visible-xs-inline"></span>
                {{CATEGORY_NAME (PICK_CATEGORY ../categories category) ../locale}}
              {{/if}}
              </div>
              <div class="col-sm-4">
                <a href="/board/free/{{seq}}?page={{../number}}&category={{category}}">
                {{#if status.delete}}
                  <strong>{{TRANSLATION "board.msg.deleted"}}</strong>
                {{else}}
                  <strong>{{subject}}</strong>
                {{/if}}
                {{#if commentCount}}
                  <span class="text-success">&nbsp;[{{commentCount}}]</span>
                {{/if}}
                </a>
                &nbsp;
                {{#if (EQ status.device 'MOBILE')}}<i aria-hidden="true" class="icon-screen-smartphone"></i>{{/if}}
                {{#if (EQ status.device 'TABLET')}}<i aria-hidden="true" class="icon-screen-tablet"></i>{{/if}}
                {{#if (OPR '>' galleries.length 0)}}<i aria-hidden="true" class="icon-picture text-info"></i>{{/if}}
              </div>

              <div class="col-sm-3">
                <span aria-hidden="true" class="icon-user visible-xs-inline"></span> {{writer.username}} &mid;
                {{DATE_FORMAT (DATE_BY_ID id) (TERNARY (OPR '>' ../todayDate (DATE_BY_ID id)) 'LL' 'LTS')}}
              </div>
              <div class="col-sm-3">
                <span aria-hidden="true" class="icon-eye"></span> <strong>{{views}}</strong> &mid;
                <span class="text-primary">
                  <i class="fa fa-thumbs-o-up"></i>
                  <strong>{{likingCount}}</strong>
                </span> &mid;
                <span class="text-danger">
                  <i class="fa fa-thumbs-o-down"></i>
                  <strong>{{dislikingCount}}</strong>
                </span>
              </div>
            </div> <!-- /row -->
          </li>
        {{/each}}
      </ul>
    </div>

    {{> write_button}}

    <div class="text-left" ng-show="totalItems > 0">
      <uib-pagination ng-model="currentPage" total-items="totalItems" max-size="10" items-per-page="itemsPerPage" previous-text="&lsaquo;" next-text="&rsaquo;" ng-change="pageChanged()"></uib-pagination>
    </div>

    <!--=== End Content Part ===-->
  </div>

  {{> footer}}

</div><!-- /.container -->

<script src="/bower_components/jquery/dist/jquery.js"></script>
<script src="/bower_components/bootstrap/dist/js/bootstrap.js"></script>
<script src="/unify/assets/plugins/back-to-top.js"></script>
<script src="/unify/assets/plugins/smoothScroll.js"></script>
<script src="/unify/assets/plugins/scrollbar/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="/unify/assets/js/app.js"></script>
<script src="/bower_components/angular/angular.js"></script>
<script src="/bower_components/angular-sanitize/angular-sanitize.js"></script>
<script src="/bower_components/angular-animate/angular-animate.js"></script>
<script src="/bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
<script src="/jakduk/js/jakduk.js"></script>

<script src="/bower_components/angular-i18n/angular-locale_{{locale}}.js"></script>

<script type="text/javascript">
  angular.module("jakdukApp", [
    "ngAnimate",
    "ui.bootstrap",
    'jakdukCommon'
  ]).controller("boardCtrl", ['$scope', function ($scope) {
    var page = parseInt('{{number}}');
    var size = parseInt('{{size}}');
    var total = parseInt('{{totalElements}}');

    if (page > 0) {
      $scope.currentPage = page;
    } else {
      $scope.currentPage = 1;
    }
    $scope.totalItems = total;
    $scope.itemsPerPage = size;

    $scope.btnEnter = function () {
      var isValid = true;
      if ($scope.searchWords.trim() < 1) {
        isValid = false;
      }
      if (isValid) {
        location.href = '/search?q=' + $scope.searchWords.trim() + '&w=PO;CO;';
      }
    };

    $scope.pageChanged = function () {
      var page = $scope.currentPage;
      location.href = '/board/free?page=' + page + '&category={{category}}';
    };
  }]);

  $(document).ready(function () {
    App.init();
  });
</script>
