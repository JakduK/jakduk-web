<!DOCTYPE html>
<!--[if IE 9]>
<html lang="{{locale}}" class="ie9" ng-app="jakdukApp"><![endif]-->
<!--[if !IE]> -->
<html lang="{{locale}}" ng-app="jakdukApp"><!-- <![endif]-->
  <head>
    <title>{{TRANSLATION "user.sign.in"}} &middot; {{TRANSLATION "common.jakduk"}}</title>
    {{> html_header}}
    <link rel="stylesheet" href="/bower_components/bootstrap/dist/css/bootstrap.css"/>
    <link rel="stylesheet" href="/bower_components/font-awesome/css/font-awesome.css"/>
    <link rel="stylesheet" href="/unify/assets/css/style.css"/>
    <link rel="stylesheet" href="/unify/assets/css/headers/header-default.css"/>
    <link rel="stylesheet" href="/unify/assets/css/footers/footer-v3.css"/>
    <link rel="stylesheet" href="/unify/assets/plugins/animate.css"/>
    <link rel="stylesheet" href="/unify/assets/plugins/line-icons/line-icons.css"/>
    <link rel="stylesheet" href="/unify/assets/css/theme-colors/blue.css"/>
    <link rel="stylesheet" href="/unify/assets/css/pages/page_log_reg_v1.css"/>
    <link rel="stylesheet" href="/unify/assets/plugins/ladda-buttons/css/custom-lada-btn.css"/>
    <link rel="stylesheet" href="/unify/assets/plugins/line-icons-pro/styles.css"/>
    <link rel="stylesheet" href="/unify/assets/plugins/brand-buttons/css/brand-buttons.min.css"/>
    <link rel="stylesheet" href="/jakduk/css/jakduk.css"/>
  </head>

  <body class="header-fixed" ng-controller="resetPasswordCtrl">
    <div class="wrapper">

      {{> navigation_header}}

      <!--=== Breadcrumbs ===-->
      <div class="breadcrumbs">
        <div class="container">
          <h1 class="pull-left">{{TRANSLATION "user.sign.forgot.password"}}</h1>
        </div><!--/container-->
      </div><!--/breadcrumbs-->
      <!--=== End Breadcrumbs ===-->

      <div class="container content">

        <div class="row">
          <div class="col-md-4 col-md-offset-4 col-sm-6 col-sm-offset-3">
            <form action="/password/reset" class="reg-page" name="resetForm" method="POST" ng-submit="onSubmit($event)">
              <input id="code" name="code" type="hidden" value="{{code}}">

              <div class="reg-header">
                <h2>{{TRANSLATION "user.msg.reset.your.password.title"}}</h2>
              </div>

              <div class="form-group">
                <h4 class="text-center">{{subject}}</h4>
                <p>{{TRANSLATION "user.msg.input.new.password"}}</p>

                <div class="input-group has-feedback"
                  ng-class="{'has-success':resetForm.password.$valid, 'has-error':resetForm.password.$invalid}">
                  <span class="input-group-addon"><i class="fa fa-lock fa-fw"></i></span>

                  <input type="password" name="password" class="form-control" placeholder='{{TRANSLATION "user.placeholder.new.password"}}'
                    ng-model="password" ng-keyup="validationPassword()"
                    ng-required="true" ng-minlength="passwordLengthMin" ng-maxlength="passwordLengthMax" autofocus/>

                  <span class="glyphicon form-control-feedback" ng-class="{'glyphicon-ok':resetForm.password.$valid, 'glyphicon-remove':resetForm.password.$invalid}"></span>
                </div>
                <span ng-class="passwordAlert.classType" ng-show="passwordAlert.msg" ng-bind="passwordAlert.msg"></span>
              </div>

              <button type="submit" class="btn btn-u rounded btn-block ladda-button" ladda="btnSubmit" data-style="expand-right">
                {{TRANSLATION "common.button.user.password.update"}}
              </button>

              <button type="button" class="btn btn-info btn-block rounded" onclick="location.href='/login'">
                {{TRANSLATION "common.button.back.to.login"}}
              </button>
            </form>
          </div>
        </div><!--/row-->
      </div>

      {{> footer}}

    </div><!-- /.container -->

    <script src="/bower_components/jquery/dist/jquery.js"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script src="/unify/assets/plugins/ladda-buttons/js/spin.js"></script>
    <script src="/unify/assets/plugins/ladda-buttons/js/ladda.js"></script>
    <script src="/unify/assets/plugins/back-to-top.js"></script>
    <script src="/unify/assets/plugins/smoothScroll.js"></script>
    <script src="/unify/assets/plugins/scrollbar/js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="/unify/assets/js/app.js"></script>
    <script src="/bower_components/angular/angular.js"></script>
    <script src="/bower_components/angular-cookies/angular-cookies.js"></script>
    <script src="/bower_components/angular-ladda/dist/angular-ladda.js"></script>
    <script src="/jakduk/js/jakduk.js"></script>

    <script src="/bower_components/angular-i18n/angular-locale_{{locale}}.js"></script>

    <script type="text/javascript">

      angular.module("jakdukApp", ["angular-ladda", 'jakdukCommon'])
        .controller("resetPasswordCtrl", function ($scope) {
          $scope.passwordLengthMin = Jakduk.FormPasswordLengthMin;
          $scope.passwordLengthMax = Jakduk.FormPasswordLengthMax;

          $scope.passwordAlert = {};

          $scope.onSubmit = function (event) {
            if ($scope.resetForm.$valid) {
              $scope.btnSubmit = true;
            } else {
              $scope.validationPassword();
              event.preventDefault();
            }
          };

          $scope.validationPassword = function () {
            if ($scope.resetForm.password.$invalid) {
              if ($scope.resetForm.password.$error.required) {
                $scope.passwordAlert = {
                  "classType": "text-danger",
                  "msg": '{{TRANSLATION "common.msg.required"}}'
                };
              } else if ($scope.resetForm.password.$error.minlength || $scope.resetForm.password.$error.maxlength) {
                $scope.passwordAlert = {
                  "classType": "text-danger",
                  "msg": '{{TRANSLATION "Size.userWrite.password"}}'
                };
              }
            } else {
              $scope.passwordAlert = {
                "classType": "text-success",
                "msg": '{{TRANSLATION "user.msg.avaliable.data"}}'
              };
            }
          };
        });

      $(document).ready(function () {
        App.init();
      });
    </script>
  </body>
</html>
